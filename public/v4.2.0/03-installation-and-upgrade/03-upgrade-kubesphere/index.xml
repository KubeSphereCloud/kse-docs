<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>升级 KubeSphere  on KubeSphere</title>
    <link>/v4.2.0/03-installation-and-upgrade/03-upgrade-kubesphere/</link>
    <description>Recent content in 升级 KubeSphere  on KubeSphere</description>
    <generator>Hugo -- gohugo.io</generator>
    <copyright>©2022 QingCloud, Inc. All rights reserved</copyright><atom:link href="/v4.2.0/03-installation-and-upgrade/03-upgrade-kubesphere/index.xml" rel="self" type="application/rss+xml" />
    <item>
      <title>从 KubeSphere 企业版 v4.1.x 在线升级到 v4.2.0</title>
      <link>/v4.2.0/03-installation-and-upgrade/03-upgrade-kubesphere/03-online-upgrade-kubephere-from-4.1.x/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      
      <guid>/v4.2.0/03-installation-and-upgrade/03-upgrade-kubesphere/03-online-upgrade-kubephere-from-4.1.x/</guid>
      <description>本节介绍如何在可访问 Internet 的情况下从 KubeSphere 企业版 v4.1.2 或 v4.1.3 升级到 KubeSphere 企业版 v4.2.0。
 前提条件   请确保当前 KubeSphere 版本为 v4.1.2 或 v4.1.3。
  请确保当前 Kubernetes 版本为 v1.23.x ~ v1.32.x。
  若扩展组件有特殊配置，需备份扩展组件配置。在“扩展组件配置”对话框中，下载文件备份。
   为避免数据丢失，请提前备份所有重要数据。
     注意事项  如果已在 4.1.x 版本中自定义配置过 nodeShell 镜像，升级时注意在升级配置文件 kse-v4.2.0-host-custom-values.yaml 中按照如下方式指定 nodeShell 镜像。示例如下：
若在 v4.1.x 中配置为：
 nodeShell: image: registry: &amp;#34;&amp;#34; repository: kubesphereio/kubectl tag: &amp;#34;v1.27.12&amp;#34; pullPolicy: IfNotPresent   需在 kse-v4.</description>
    </item>
    
    <item>
      <title>从 KubeSphere 企业版 v4.1.x 离线升级到 v4.2.0</title>
      <link>/v4.2.0/03-installation-and-upgrade/03-upgrade-kubesphere/04-offline-upgrade-kubephere-from-4.1.x/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      
      <guid>/v4.2.0/03-installation-and-upgrade/03-upgrade-kubesphere/04-offline-upgrade-kubephere-from-4.1.x/</guid>
      <description>本节介绍如何在无法访问 Internet 的情况下从 KubeSphere 企业版 v4.1.2 离线升级到 KubeSphere 企业版 v4.2.0。
 前提条件   联系 KubeSphere 交付服务专家获取 KubeSphere v4.2.0 安装包。
  请确保当前 KubeSphere 版本为 v4.1.2 或 v4.1.3。
  请确保当前 Kubernetes 版本为 v1.23.x ~ v1.32.x。
  若扩展组件有特殊配置，需备份扩展组件配置。在“扩展组件配置”对话框中，下载文件备份。
   为避免数据丢失，请提前备份所有重要数据。
     注意事项  如果已在 4.1.x 版本中自定义配置过 nodeShell 镜像，升级时注意在升级配置文件 kse-v4.2.0-host-custom-values.yaml 中按照如下方式指定 nodeShell 镜像。示例如下：
若在 v4.1.x 中配置为：
 nodeShell: image: registry: &amp;#34;&amp;#34; repository: kubesphereio/kubectl tag: &amp;#34;v1.</description>
    </item>
    
    <item>
      <title>从 KubeSphere 开源版升级到社区版 v4.2.0</title>
      <link>/v4.2.0/03-installation-and-upgrade/03-upgrade-kubesphere/05-online-upgrade-to-community-4.2.x/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      
      <guid>/v4.2.0/03-installation-and-upgrade/03-upgrade-kubesphere/05-online-upgrade-to-community-4.2.x/</guid>
      <description>本节介绍如何从 KubeSphere 开源版 v3.x 或 v4.x 升级到 KubeSphere 社区版 v4.2.0。
 前提条件   请确保当前 Kubernetes 版本为 v1.23.x ~ v1.32.x。
  若扩展组件有特殊配置，需备份扩展组件配置。在“扩展组件配置”对话框中，下载文件备份。
   为避免数据丢失，请提前备份所有重要数据。
     步骤 1：升级前环境检查  检查当前集群规模。
KubeSphere 社区版的总集群规模不得超过 128 vCPU。集群超出规模后，仅可查看资源，无法创建、变更资源。在升级前运行以下脚本查看当前集群的规模。
  创建 collect-node-info.sh 脚本文件。
vi collect-node-info.sh   粘贴以下内容并保存：
 #!/bin/bash t=0 printf &amp;#34;┌────────────────────┬─────────────────────────┬────────────┐\n│ %-18s │ %-23s │ %-10s │\n├────────────────────┼─────────────────────────┼────────────┤\n&amp;#34; &amp;#34;Cluster&amp;#34; &amp;#34;Node&amp;#34; &amp;#34;CPU(cores)&amp;#34; while IFS=$&amp;#39;\t&amp;#39; read -r c k; do [[ -n $k ]] &amp;amp;&amp;amp; f=$(mktemp) &amp;amp;&amp;amp; echo &amp;#34;$k&amp;#34;|base64 -d&amp;gt;&amp;#34;$f&amp;#34; &amp;amp;&amp;amp; a=&amp;#34;--kubeconfig=$f&amp;#34; cc=0 while read -r n cpu; do [[ $cpu == *m ]] &amp;amp;&amp;amp; v=$(awk &amp;#34;BEGIN{print ${cpu%m}/1000}&amp;#34;) || v=$cpu printf &amp;#34;│ %-18s │ %-23s │ %-10s │\n&amp;#34; &amp;#34;$c&amp;#34; &amp;#34;$n&amp;#34; &amp;#34;$v&amp;#34; cc=$(awk &amp;#34;BEGIN{print $cc+$v}&amp;#34;) done &amp;lt; &amp;lt;(kubectl $a get nodes -o jsonpath=&amp;#39;{range .</description>
    </item>
    
  </channel>
</rss>
